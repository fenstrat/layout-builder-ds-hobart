<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Ultimate guide to Layout Builder - Drupal South Hobart 2019</title>

    <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/moon.css">
    <style>
      body {
        background: #061745;
      }

      h1, h2, h3, h4, h5, h6 {
        text-transform: none !important;
      }

      @keyframes fadeIn {
        0% {
          opacity:0;
        }
        100% {
          opacity:1;
        }
      }
      .fade-in {
        animation: fadeIn ease 2s;
      }
    </style>

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/monokai.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
  </head>

  <body>

    <div class="reveal">
      <div class="slides">

        <section data-state="slide-one">
          <h2>Ultimate guide to Layout Builder</h2>
          <img src="media/ds-logo.png" style="width: 50%; background: none; border: none; box-shadow: none">
        </section>

        <section data-state="slide-two">
          <h2>Who?</h2>
          <p>Saul Willers</p>
          <p>Senior Backend Developer @ PreviousNext</p>
          <p><a href="https://www.drupal.org/u/fenstrat">drupal.org/u/fenstrat</a></p>
          <aside class="notes">
            <p>1/30</p>
            <ul>
              <li>PNX clients; Amaysim, TfNSW, BCC</li>
              <li>I live in Northern Rivers of NSW</li>
              <li>20+ years web dev</li>
              <li>10+ years Drupal full time</li>
              <li>Drupal Chile, DGC</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>What?</h2>
          <ul>
            <li>Best practice UI/UX</li>
            <li>Performance</li>
            <li>Gotchas</li>
          </ul>
          <aside class="notes">
            <p>2/30</p>
            <ul>
              <li>Very quickly introduce LB</li>
              <li>Best practice, UI improvements, evolving space</li>
              <li>Performance considerations</li>
              <li>Gotchas, translation, API access (e.g. JSON API)</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>What is Layout Builder?</h2>
          <ul>
            <li>Layout all your content</li>
            <li>Stable in Drupal 8.7+</li>
            <li>Works on all content entities</li>
          </ul>
          <aside class="notes">
            <p>3/30</p>
            <ul>
              <li>Similar to panels in Drupal 7</li>
              <li>Allows control over entity type layout, or per entity layout</li>
              <li>Version shipped with 8.7 was MVP</li>
              <li>UX still needs polish</li>
              <li>Single core based approach to content layout, big deal</li>
            </ul>
          </aside>
        </section>

        <section>
          <img src="media/lb-sample.jpg">
        </section>

        <section>
          <h2>Editorial UI/UX</h2>
          <aside class="notes">
            <p>4/30</p>
            <ul>
              <li>Best practice</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Data modelling</h2>
          <ul>
            <li>Excellent for custom layouts</li>
            <li>Structured data still very important</li>
          </ul>
          <aside class="notes">
            <p>5/30</p>
            <ul>
              <li>1 - Editorial UI</li>
              <li>Excels at custom layouts</li>
              <li>Careful not to loose structure data</li>
              <li>Fields on content type still important</li>
              <li>Don't just put everything into a non reusable LB block, we don't want to recreate the worst bits of WP's Gutenberg here!</li>
              <li>Leads into Metadata vs Content</li>
            </ul>
          </aside>
        </section>

        <section>
          <img src="media/default-lb-edit-ui.png" style="width: 75%">
          <aside class="notes">
            <p>6/30</p>
            <ul>
              <li>Default LB content edit</li>
              <li>"Edit" contains fields</li>
              <li>"Layout" contains blocks, same LB interface we saw before</li>
              <li>Makes sense from Drupal data modelling.</li>
              <li>Confusing for editors?</li>
            </ul>
          </aside>
        </section>

        <section>
          <img src="media/edit-metadata-2.png" style="width: 80%">
          <aside class="notes">
            <p>7/30</p>
            <ul>
              <li>Customised tabs, based on client feedback</li>
              <li>Addition of vertical tabs</li>
              <li>"Edit metadata" contains fields not directly displayed on the page</li>
              <li>Supporting fields like teasers for search indexing</li>
            </ul>
          </aside>
        </section>

        <section>
          <img src="media/edit-metadata-1.png" style="width: 80%">
          <aside class="notes">
            <p>7/30</p>
            <ul>
              <li>"Content" tab contains fields which display on the page</li>
            </ul>
          </aside>
        </section>

        <section>
          <img src="media/edit-content.png" style="width: 70%">
          <aside class="notes">
            <p>8/30</p>
            <ul>
              <li>"Edit content" is then "Layout" from default LB</li>
              <li>Maps better to content authors understanding of page content</li>
              <li>Is this perfect? No, but this whole space is a WIP</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Collection of fields in a block</h2>
          <ul>
            <li><a href="https://www.drupal.org/project/paragraphs">Paragraphs</a></li>
            <li><a href="https://www.drupal.org/project/paragraph_blocks">Paragraphs Blocks</a></li>
            <li><a href="https://www.drupal.org/project/ideas/issues/607396">Fieldable fields in core</a></li>
          </ul>
          <aside class="notes">
            <p>9/30</p>
            <ul>
              <li>2 - Editorial UI</li>
              <li>Blocks may still need multiple values, each with multiple fields, e.g. opening hours</li>
              <li>Paragraphs recommended tool for collection of fields</li>
              <li>LB allows paragraphs to continue to structure data, rather than a presentation tool</li>
              <li>Paragraph blocks allows choosing individual deltas for display in LB</li>
              <li>Fieldable fields, possible paragraph replacement?!</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Block theming</h2>
          <p>Blocks need to accommodate different contexts</p>
          <aside class="notes">
            <p>10/30</p>
            <ul>
              <li>3 - Editorial UI</li>
              <li>Full LB editorial experience can result in blocks being placed in very different situations</li>
              <li>Demonstrate with a video</li>
            </ul>
          </aside>
        </section>

        <section>
          <video data-autoplay src="media/responsive-block-design.mp4"></video>
          <aside class="notes">
            <p>12/30</p>
            <ul>
              <li>If this is too much flexibility, LB library can restrict this</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Handling complex edit forms</h2>
          <ul>
            <li>Default off canvas tray is small</li>
            <li><a href="https://www.drupal.org/project/layout_builder_modal">LB Modal</a></li>
          </ul>
          <aside class="notes">
            <p>13/30</p>
            <ul>
              <li>4 - Editorial UI</li>
              <li>Easy to outgrow the off canvas tray</li>
              <li>LB Modal module can solve this, renders edit forms in a modal instead of the off canvas tray</li>
              <li>Note it's not yet fully accessible (unlike LB core)</li>
              <li>Another custom solution is to widen the off canvas tray</li>
            </ul>
          </aside>
        </section>

        <section>
          <img src="media/wider-off-canvas-dialog.png" style="width: 80%">
        </section>

        <section>
          <h2>Restrict available options</h2>
          <ul style="float: left; width: 35%; margin-left: 2em;">
            <li><a href="https://www.drupal.org/project/layout_builder_restrictions">LB Restrictions</a></li>
            <li>Restrict available;</li>
            <ul>
              <li>Layouts</li>
              <li>Blocks</li>
            </ul>
          </ul>
          <div class="fragment" style="float: left; width: 25%">
            <img src="media/restrictions-layouts.png">
          </div>
          <div class="fragment" style="float: left; width: 25%; margin-left: 3%">
            <img src="media/restrictions-blocks.png">
          </div>
          <aside class="notes">
            <p>14/30</p>
            <ul>
              <li>5 - Editorial UI</li>
              <li>By default LB shows a lot of options</li>
              <li>All layouts</li>
              <li>All blocks (including all entity-specific fields)</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Restrict layout options</h2>
          <ul>
            <li><a href="https://www.drupal.org/project/layout_library">LB Library</a></li>
            <li>Pre-defined layouts</li>
            <li>Restrict editor choices</li>
          </ul>
          <aside class="notes">
            <p>15/30</p>
            <ul>
              <li>6 - Editorial UI</li>
              <li>Module avoids the potential of too much flexibility with bespoke layouts</li>
              <li>Allows site builders to create and deploy pre-defined layouts</li>
              <li>This layout library restricts editors to pre-defined layouts</li>
              <li>Editors can still customise layouts on a per-content-item basis</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Style a section/block</h2>
          <ul style="float: left; width: 35%; margin-left: 2em;">
            <li><a href="https://www.drupal.org/project/layout_builder_styles">LB Styles</a></li>
            <li>Apply classes to;</li>
            <ul>
              <li>Sections</li>
              <li>Blocks</li>
            </ul>
          </ul>
          <div class="fragment" style="float: left; width: 25%">
            <img src="media/styles-1-section.png">
          </div>
          <div class="fragment" style="float: left; width: 25%; margin-left: 3%">
            <img src="media/styles-2-block.png">
          </div>
          <aside class="notes">
            <p>16/30</p>
            <ul>
              <li>7 - Editorial UI</li>
              <li>Also adds a block template suggestion</li>
              <li>Can also be done in custom code</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>LB Everywhere</h2>
          <ul>
            <li><a href="https://www.drupal.org/project/lb_everywhere">LB Everywhere</a></li>
            <li>Edit other regions with LB</li>
          </ul>
          <aside class="notes">
            <p>17/30</p>
            <ul>
              <li>8 - Editorial UI</li>
              <li>New contrib module from Tim Plunkett</li>
              <li>Similar concepts to Panels Everywhere, i.e. control site chrome</li>
            </ul>
          </aside>
        </section>

        <section>
          <img src="media/lb-everywhere-1.png">
          <aside class="notes">
            <p>18/30</p>
          </aside>
        </section>

        <section>
          <img src="media/lb-everywhere-2.png">
          <aside class="notes">
            <p>19/30</p>
          </aside>
        </section>

        <section>
          <h2>Performance</h2>
          <aside class="notes">
            <p>20/30</p>
          </aside>
        </section>

        <section>
          <h2>Restrict blocks</h2>
          <ul>
            <li><a href="https://www.drupal.org/project/block_blacklist">Block blacklist</a></li>
            <li>Control exposed blocks via custom code</li>
          </ul>
          <aside class="notes">
            <p>21/30</p>
            <ul>
              <li>1 - Performance</li>
              <li>Drupal exposes a huge amount blocks, e.g. every field on every entity type</li>
              <li>LB performance can suffer as a result</li>
              <li>Many LB performance improvements focus around this</li>
              <li>Block blacklist can totally remove a given selection of blocks from ever being exposed</li>
              <li>Custom code, useful for entities which you have full control over</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Patches for performance</h2>
          <ul>
            <li><a href="https://www.drupal.org/project/drupal/issues/2981889">#2981889</a> Recursive rendering (committed! >= 8.7.9)</li>
            <li><a href="https://www.drupal.org/project/drupal/issues/3043330">#3043330</a> Only create blocks for LB enabled entities</li>
          </ul>
          <aside class="notes">
            <p>22/30</p>
            <ul>
              <li>2 - Performance</li>
              <li>2nd patch is a complex problem space, trying to automatically reduce the number field blocks exposed</li>
              <li>Good news is LB performance has come a long way recently</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Gotchas</h2>
          <aside class="notes">
            <p>23/30</p>
          </aside>
        </section>

        <section>
          <h2>Translation</h2>
          <ul>
            <li>Not yet supported in core</li>
            <li>2 contrib options:</li>
            <ul>
              <li><a href="https://www.drupal.org/project/layout_builder_st">Symmetric translations</a></li>
              <li><a href="https://www.drupal.org/project/layout_builder_at">Asymmetric translations</a></li>
            </ul>
          </ul>
          <aside class="notes">
            <p>24/30</p>
            <ul>
              <li>1 - Gotcha</li>
              <li>Translation-specific layouts are not supported</li>
              <li>Contrib offers support</li>
              <li>Symmetric, translate blocks, can't add/delete blocks. Likely go into core</li>
              <li>Asymmetric, can add/edit blocks, unlikely to go into core</li>
              <li>Two approaches are incompatible</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Form blocks break layout save</h2>
          <ul>
            <li>Parent form never saves</li>
            <li><a href="https://www.drupal.org/project/drupal/issues/3045171">#3045171</a> Ongoing work in core</li>
          </ul>
          <aside class="notes">
            <p>25/30</p>
            <ul>
              <li>2 - Gotcha</li>
              <li>Effects any form that is rendered in the LB UI</li>
              <li>Form e.g. Search, Views exposed filters, Webform</li>
              <li>Custom form alter can replace <code><form></code> with placeholders</li>
              <li>Ongoing work in core to solve problem generically</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Concurrent editing is confusing</h2>
          <ul>
            <li>Both editors see changes other user is making</li>
            <li><a href="https://www.drupal.org/project/drupal/issues/3025231">#3025231</a> Ongoing work in core</li>
          </ul>
          <aside class="notes">
            <p>26/30</p>
            <ul>
              <li>3 - Gotcha</li>
              <li>WIP to mimic the views UI locking system</li>
              <li>Store lock in <code>tempstore</code></li>
              <li>Show message in UI to break lock</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>API access</h2>
          <ul>
            <li>No data is exposed</li>
            <li><a href="https://www.drupal.org/project/drupal/issues/2942975">#2942975</a> Ongoing work in core</li>
          </ul>
          <aside class="notes">
            <p>27/30</p>
            <ul>
              <li>4 - Gotcha</li>
              <li>All HTTP API access to Layout Builder data is currently forbidden</li>
              <li>If accessed via REST an entities layout field is empty</li>
              <li>Breaks things like default_content</li>
              <li>Tricky problem space, Normalisation of layout field, validation (currently heavily tied to UI), access</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Resources</h2>
          <ul>
            <li><a href="https://www.drupal.org/docs/8/core/modules/layout-builder">Core docs</a></li>
            <li>Talks from DrupalCon</li>
            <ul>
              <li><a href="https://drupal.kuoni-congress.info/2019/program/abstract/402">Ecosystem</a></li>
              <li><a href="https://drupal.kuoni-congress.info/2019/program/abstract/319">What's next</a></li>
            </ul>
            <li><a href="https://www.drupal.org/project/issues/search/drupal?project_issue_followers=&status%5B%5D=Open&component%5B%5D=layout_builder.module&issue_tags_op=%3D">Core issue queue</a></li>
          </ul>
          <aside class="notes">
            <p>28/30</p>
            <ul>
              <li>Core docs are pretty good</li>
              <li>Amsterdam talks; Boyan Borisov, Tim Plunkett</li>
              <li>Get involved!</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Summary</h2>
          <aside class="notes">
            <p>29/30</p>
            <ul>
              <li>A lot of evolving best practice, but def ready for use now</li>
              <li>Consider content architecture, don't just shove everything into LB blocks</li>
              <li>There are gotchas, consider things like translation, API access early in design decisions</li>
              <li>It's awesome to finally have one "core approved" way of doing layouts!</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2 style="margin-bottom: 1em">Thank you</h2>
          <h2>Questions?</h2>
          <aside class="notes">
            <p>30/30</p>
          </aside>
        </section>
      </div>
    </div>

    <script src="js/reveal.js"></script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/notes/notes.js', async: true },
          { src: 'plugin/highlight/highlight.js', async: true }
        ]
      });

      Reveal.addEventListener( 'slide-one', function() {
        document.getElementById('header-logo').style.display = 'none';
        document.getElementById('footer-logo').style.display = 'none';
      });
      Reveal.addEventListener( 'slide-two', function() {
        document.getElementById('header-logo').style.display = 'block';
        document.getElementById('footer-logo').style.display = 'block';
      });
    </script>

    <div id="header-logo" class="share-reveal fade-in" style="position: absolute; top: 16px; left: 16px;">
      <img src="media/ds-logo.png" style="width: 15%">
    </div>
    <div id="footer-logo" class="share-reveal fade-in" style="position: absolute; bottom: 16px; left: 16px; z-index: 20;">
      <svg style="width:75%;" xmlns="http://www.w3.org/2000/svg" width="395" height="39" viewBox="0 0 395 39" aria-labelledby="title desc" role="img">
        <title id="title">PreviousNext</title>
        <path fill="#FFFFFF" d="M0 1.6c0-.5.4-1 1-1h12.6c6.6 0 12 5.4 12 11.9 0 6.6-5.4 12.1-12 12.1H7v12.6c0 .5-.5 1-1 1H1c-.6 0-1-.5-1-1V1.6zm13.2 16.3c3 0 5.5-2.4 5.5-5.6 0-2.9-2.5-5.2-5.5-5.2H7v10.8h6.2zM30.7 1.6c0-.5.4-1 1-1H47c6.4 0 11.7 5.1 11.7 11.5 0 4.9-3.3 9-7.9 10.8l7.3 13.6c.4.7 0 1.6-.9 1.6h-5.6c-.5 0-.8-.3-.9-.5l-7.1-14.2h-6v13.7c0 .5-.5 1-1 1h-4.9c-.6 0-1-.5-1-1V1.6zm15.7 16c2.8 0 5.3-2.5 5.3-5.5 0-2.8-2.5-5.2-5.3-5.2h-8.7v10.7h8.7zm18.9-16c0-.5.4-1 1-1h21.8c.6 0 1 .5 1 1V6c0 .5-.4 1-1 1H72.3v8.8h13.2c.5 0 1 .5 1 1v4.5c0 .6-.5 1-1 1H72.3v9.4h15.9c.6 0 1 .5 1 1v4.4c0 .5-.4 1-1 1H66.3c-.6 0-1-.5-1-1V1.6zm27.5.3c-.3-.7.1-1.4.9-1.4h5.5c.5 0 .8.3.9.6l10.3 23.1h.4L121 1.1c.1-.3.4-.6.9-.6h5.5c.8 0 1.2.7.9 1.4L111.7 38c-.2.3-.4.6-.9.6h-.5c-.5 0-.8-.3-.9-.6L92.8 1.9zm39.3-.3c0-.5.5-1 1-1h5c.5 0 1 .5 1 1v35.5c0 .5-.5 1-1 1h-5c-.5 0-1-.5-1-1V1.6zM164.4 0c10.7 0 19.3 8.6 19.3 19.4 0 10.7-8.6 19.2-19.3 19.2-10.7 0-19.2-8.5-19.2-19.2 0-10.8 8.5-19.4 19.2-19.4m0 31.6c6.8 0 12.3-5.5 12.3-12.3 0-6.8-5.6-12.4-12.3-12.4-6.7 0-12.3 5.6-12.3 12.4 0 6.8 5.6 12.3 12.3 12.3m24.7-30c0-.5.5-1 1-1h5.1c.6 0 1 .5 1 1v21.9c0 4.6 3.1 8.1 7.8 8.1 4.7 0 7.8-3.6 7.8-8.1v-22c0-.5.4-1 1-1h5.1c.5 0 1 .5 1 1v22.3c0 8.1-6.5 14.7-15 14.7-8.4 0-14.9-6.6-14.9-14.7V1.6h.1zM225 32.8l1.9-3.3c.4-.8 1.3-.8 1.8-.4.3.2 4.6 3.3 8.1 3.3 2.8 0 4.9-1.8 4.9-4.1 0-2.7-2.3-4.6-6.8-6.4-5-2-10.1-5.3-10.1-11.6 0-4.8 3.5-10.3 12.1-10.3 5.5 0 9.7 2.8 10.7 3.6.5.3.7 1.2.3 1.8l-2 3.1c-.4.6-1.2 1.1-1.9.6-.4-.3-4.5-2.9-7.5-2.9-3.1 0-4.7 2-4.7 3.8 0 2.5 2 4.2 6.3 6 5.2 2.1 11.2 5.2 11.2 12.1 0 5.5-4.8 10.6-12.3 10.6-6.8 0-10.7-3.2-11.8-4.2-.5-.6-.7-.8-.2-1.7M256.9 1c0-.5.5-1 1-1h1.3l22.3 23.7h.1V1.6c0-.5.4-1 1-1h4.9c.5 0 1 .5 1 1v36.1c0 .5-.5 1-1 1h-1.3L263.9 14h-.1v23.1c0 .5-.4 1-1 1h-4.9c-.5 0-1-.5-1-1V1zm40.4.6c0-.5.4-1 1-1h21.8c.6 0 1 .5 1 1V6c0 .5-.4 1-1 1h-15.9v8.8h13.2c.5 0 1 .5 1 1v4.5c0 .6-.5 1-1 1h-13.2v9.4h15.9c.6 0 1 .5 1 1v4.4c0 .5-.4 1-1 1h-21.8c-.6 0-1-.5-1-1V1.6zM369.4 7h-8.2c-.6 0-1-.5-1-1V1.6c0-.5.4-1 1-1h23.4c.6 0 1 .5 1 1V6c0 .5-.4 1-1 1h-8.2v30.1c0 .5-.5 1-1 1h-5c-.5 0-1-.5-1-1V7z"/>
        <path fill="#3DB7E2" d="M356.7 2c.4-.7 0-1.5-.9-1.5h-6.2c-.4 0-.8.3-.9.5l-6.9 11.3 4.2 6.4L356.7 2zm.3 34.6l-11-17.7-4.2 6.4 7.7 12.3c.1.2.5.5.9.5h5.8c.8 0 1.3-.8.8-1.5"/>
        <path fill="#FFFFFF" d="M346 18.9l-.1-.1-4.2-6.4L334.6.8c-.2-.2-.4-.5-.9-.5h-6.4c-.9 0-1.4.8-.9 1.5l11.1 17.1-11.5 18c-.4.7 0 1.5 1 1.5h6c.4 0 .8-.3.9-.5l7.8-12.5.1-.1 4.2-6.4zm45.4-12c-1.8 0-3.2-1.5-3.2-3.2 0-1.8 1.4-3.2 3.2-3.2 1.8 0 3.2 1.5 3.2 3.2.1 1.7-1.4 3.2-3.2 3.2m.1-6.2c-1.7 0-2.9 1.3-2.9 3s1.3 2.9 2.9 2.9c1.7 0 2.9-1.3 2.9-3S393.1.7 391.5.7m.6 3.2l1 1.3h-.6l-1-1.2h-.8v1.2h-.5V1.9h1.5c.7 0 1.2.4 1.2 1s-.3.9-.8 1m-.5-1.5h-1v1.2h.9c.5 0 .8-.2.8-.6.1-.4-.2-.6-.7-.6"/>
      </svg>
    </div>

  </body>
</html>
